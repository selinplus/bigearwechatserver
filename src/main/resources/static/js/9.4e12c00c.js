(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{IdcS:function(e,t,a){"use strict";var o=a("tWI/"),r=a.n(o);r.a},rLWk:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row justify-center"},[a("q-input",{staticClass:"col-xs-12 q-mb-md",attrs:{"float-label":"联系人",placeholder:"请输入联系人",before:[{icon:"person"}]},model:{value:e.order.name,callback:function(t){e.$set(e.order,"name",t)},expression:"order.name"}}),a("q-input",{staticClass:"col-xs-12 q-mb-md",attrs:{"float-label":"手机号",placeholder:"请输入手机号",before:[{icon:"phone"}]},model:{value:e.order.phone,callback:function(t){e.$set(e.order,"phone",t)},expression:"order.phone"}}),a("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"车牌号",options:e.plateNumOptions,before:[{icon:"drive_eta"}],clearable:""},model:{value:e.order.platenum,callback:function(t){e.$set(e.order,"platenum",t)},expression:"order.platenum"}}),a("div",{staticClass:"row col-xs-12"},[a("p",{staticClass:"caption"},[e._v("安检:")])]),a("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"车辆类型",options:e.vehicleOptions,before:[{icon:"format_list_bulleted"}],clearable:""},model:{value:e.vehicleType,callback:function(t){e.vehicleType=t},expression:"vehicleType"}}),a("div",{staticClass:"row q-mb-lg gutter-xl"},[a("q-checkbox",{staticClass:"col q-mr-md",attrs:{val:"路试(100)",color:"amber","left-label":"",label:"路试(100)"},model:{value:e.secuAddition,callback:function(t){e.secuAddition=t},expression:"secuAddition"}}),a("q-checkbox",{staticClass:"col",attrs:{val:"称重(100)",color:"amber","left-label":"",label:"称重(100)"},model:{value:e.secuAddition,callback:function(t){e.secuAddition=t},expression:"secuAddition"}})],1),a("div",{staticClass:"row col-xs-12"},[a("p",{staticClass:"caption"},[e._v("环检:")])]),a("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"燃油类型",options:e.fuelOptions,before:[{icon:"format_list_bulleted"}],clearable:""},model:{value:e.order.fuelType,callback:function(t){e.$set(e.order,"fuelType",t)},expression:"order.fuelType"}}),"汽油、天然气、电"==e.order.fuelType?a("div",{staticClass:"col-xs-12 row q-mb-lg gutter-y-sm"},[a("div",{staticClass:"col"},[a("q-radio",{attrs:{val:"初检(90)",color:"amber",label:"初检(90)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}})],1),a("div",{staticClass:"col"},[a("q-radio",{attrs:{val:"一次复检(0)",color:"amber",label:"一次复检(0)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}})],1),a("div",{staticClass:"col"},[a("q-radio",{attrs:{val:"二次复检(45)",color:"amber",label:"二次复检(45)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}})],1),a("div",{staticClass:"col"},[a("q-radio",{attrs:{val:"三次复检(90)",color:"amber",label:"三次复检(90)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}})],1)]):e._e(),"柴油"==e.order.fuelType?a("div",{staticClass:"row q-mb-lg gutter-y-sm"},[a("q-radio",{staticClass:"col",attrs:{val:"初检(60)",color:"amber",label:"初检(60)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}}),a("q-radio",{staticClass:"col",attrs:{val:"一次复检(0)",color:"amber",label:"一次复检(0)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}}),a("q-radio",{staticClass:"col",attrs:{val:"二次复检(30)",color:"amber",label:"二次复检(30)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}}),a("q-radio",{staticClass:"col",attrs:{val:"三次复检(60)",color:"amber",label:"三次复检(60)"},model:{value:e.envCheckType,callback:function(t){e.envCheckType=t},expression:"envCheckType"}})],1):e._e(),a("q-datetime",{staticClass:"col-xs-12 q-mb-lg",attrs:{clearable:"","float-label":"预约时间",type:"datetime",before:[{icon:"date_range"}],"first-day-of-week":1,color:"light-blue","format-model":"number",min:e.settings.startDate,max:e.settings.endDate},model:{value:e.order.orderDate,callback:function(t){e.$set(e.order,"orderDate",t)},expression:"order.orderDate"}}),a("div",{staticClass:"row q-mb-lg gutter-xl"},[a("q-radio",{staticClass:"col",attrs:{val:"网上缴费",color:"amber","left-label":"",label:"网上缴费"},model:{value:e.order.paymentMethod,callback:function(t){e.$set(e.order,"paymentMethod",t)},expression:"order.paymentMethod"}}),a("q-radio",{staticClass:"col",attrs:{val:"现场缴费",color:"amber","left-label":"",label:"现场缴费"},model:{value:e.order.paymentMethod,callback:function(t){e.$set(e.order,"paymentMethod",t)},expression:"order.paymentMethod"}})],1),a("q-btn",{staticClass:"full-width",attrs:{loading:e.btnLoading,color:"positive",label:"预约"},on:{click:e.addOrder}})],1)])},r=[];o._withStripped=!0;a("KKXr"),a("f3/d");var s=a("MVZn"),l=a.n(s),i=a("SQGN"),n=function(e,t){return Math.floor(Math.random()*(t-e)+e)+""},c=a("L2JU"),d=a("ta7f"),p=new Date,u={data:function(){return{today:p,vehicleType:"",envCheckType:"",order:{name:"",phone:"",customerId:"",platenum:"",vehicleType:"",secuAddition:"",fuelType:"",envCheckType:"",orderDate:null,paymentMethod:"",payStatus:"未支付",orderNum:"",vehicleTypeFee:0,secuAdditionFee:0,envCheckTypeFee:0,totalFee:0},settings:{startDate:p,endDate:null,hourAmount:25},plateNumOptions:[],vehicleOptions:[{label:"小、微型汽车(1)",value:"小、微型汽车(1)"},{label:"轻型汽车(210)",value:"轻型汽车(210)"},{label:"中型汽车(290)",value:"中型汽车(290)"},{label:"重型半挂车、中型半挂车、轻型半挂车(300)",value:"重型半挂车、中型半挂车、轻型半挂车(300)"},{label:"危险品挂车(390)",value:"危险品挂车(390)"},{label:"大型、重型汽车(390)",value:"大型、重型汽车(390)"}],secuAddition:[],fuelOptions:[{label:"汽油、天然气、电",value:"汽油、天然气、电"},{label:"柴油",value:"柴油"}],btnLoading:!1}},computed:l()({},Object(c["c"])(["userInfo","registerInfo"])),validations:{order:{name:{required:d["required"]},phone:{required:d["required"]},platenum:{required:d["required"]},orderDate:{required:d["required"]}}},created:function(){var e=this;if(this.registerInfo)return this.disposeUnpaid(),void this.getSettings();this.$http.post("http://selinplus.natappvip.cc/customer/list?openid="+this.userInfo.openId).then(function(t){"200"==t.data.code&&(t.data.data?(e.$store.commit("saveRegisterInfo",t.data.data),e.disposeUnpaid(),e.getSettings()):(e.$q.notify({message:"请先登记",type:"negative",color:"negative",timeout:1e3,position:"top"}),setTimeout(function(){e.$router.push("/register")},1500)))})},methods:{disposeUnpaid:function(){var e=this;this.$http.get("http://selinplus.natappvip.cc/check/order/unpaid?customerId="+this.registerInfo.customer.id).then(function(t){"200"==t.data.code&&t.data.data&&e.$router.push({name:"预约详情",params:{orderNum:t.data.data.orderNum}})})},getSettings:function(){var e=this;this.order.name=this.registerInfo.customer.name,this.order.phone=this.registerInfo.customer.phone;for(var t=0;t<this.registerInfo.cars.length;t++){var a={label:this.registerInfo.cars[t].plateNum,value:this.registerInfo.cars[t].plateNum};this.plateNumOptions.push(a)}this.$http.post("http://selinplus.natappvip.cc/order/setting/getSettings").then(function(t){t.data.data&&(e.settings=t.data.data)})},checkOrderDate:function(e){this.$http.post("http://selinplus.natappvip.cc/check/order/checkOrderDate?orderDate="+this.order.orderDate+"&hourAmount="+this.settings.hourAmount).then(function(t){e(t.data.data)})},keyValueSplit:function(e){var t=e.split("(")[0],a=parseFloat(e.split("(")[1].split(")")[0]);return{key:t,value:a}},prepareOrder:function(){if(this.order.name=this.registerInfo.customer.name,this.order.phone=this.registerInfo.customer.phone,this.order.customerId=this.registerInfo.customer.id,this.order.orderNum=Date.now()+n(1e5,999999),""!=this.vehicleType&&(this.order.vehicleType=this.keyValueSplit(this.vehicleType).key,this.order.vehicleTypeFee=this.keyValueSplit(this.vehicleType).value),""!=this.secuAddition){for(var e=[],t=0;t<this.secuAddition.length;t++){var a=this.keyValueSplit(this.secuAddition[t]);this.order.secuAdditionFee+=a.value,e.push(a.key)}this.order.secuAddition=e.join(",")}""!=this.envCheckType&&(this.order.envCheckType=this.keyValueSplit(this.envCheckType).key,this.order.envCheckTypeFee=this.keyValueSplit(this.envCheckType).value),this.order.totalFee=this.order.vehicleTypeFee+this.order.secuAdditionFee+this.order.envCheckTypeFee},addOrder:function(){var e=this;this.prepareOrder(),0!=this.order.totalFee?this.$v.order.name.required?this.$v.order.phone.required?this.$v.order.platenum.required?this.$v.order.orderDate.required?this.checkOrderDate(function(t){t?e.$q.notify(t):e.$http.post("http://selinplus.natappvip.cc/check/order/add",e.order).then(function(t){200==t.data.code?"现场缴费"==e.order.paymentMethod?e.$router.push({name:"预约详情",params:{orderNum:e.order.orderNum}}):"网上缴费"==e.order.paymentMethod&&e.$http.post("http://selinplus.natappvip.cc/pay/createOrder",{body:"JSAPITEST",outTradeNo:e.order.orderNum,totalFee:e.order.totalFee,spbillCreateIp:"218.56.36.83",notifyUrl:"http://selinplus.natappvip.cc/pay/parseOrderNotifyResult",tradeType:"JSAPI",openid:e.userInfo.openId,signType:"MD5"}).then(function(t){console.log(t.data);var a=e;i["c"](t.data,function(e){a.$router.push({name:"预约详情",params:{orderNum:a.order.orderNum}})},function(e){a.$router.push({name:"预约详情",params:{orderNum:a.order.orderNum}})})}).catch(function(e){console.log(e)}):e.$q.notify({color:"negative",icon:"mood_bad",message:t.data.message,position:"top",timeout:1e3})}).catch(function(e){console.log(e)})}):this.$q.notify("预约时间不能为空！"):this.$q.notify("车牌号不能为空！"):this.$q.notify("手机号不能为空！"):this.$q.notify("联系人不能为空！"):this.$q.notify("预约信息填写有误！")}}},h=u,v=(a("IdcS"),a("KHd+")),m=Object(v["a"])(h,o,r,!1,null,null,null);t["default"]=m.exports},"tWI/":function(e,t,a){}}]);