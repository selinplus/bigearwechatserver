(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{IdcS:function(e,t,r){"use strict";var o=r("tWI/"),a=r.n(o);a.a},rLWk:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"row justify-center"},[r("q-input",{staticClass:"col-xs-12 q-mb-md",attrs:{"float-label":"联系人",placeholder:"请输入联系人",before:[{icon:"person"}]},model:{value:e.order.name,callback:function(t){e.$set(e.order,"name",t)},expression:"order.name"}}),r("q-input",{staticClass:"col-xs-12 q-mb-md",attrs:{"float-label":"手机号",placeholder:"请输入手机号",before:[{icon:"phone"}]},model:{value:e.order.phone,callback:function(t){e.$set(e.order,"phone",t)},expression:"order.phone"}}),r("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"车牌号",options:e.plateNumOptions,before:[{icon:"drive_eta"}],clearable:""},model:{value:e.order.platenum,callback:function(t){e.$set(e.order,"platenum",t)},expression:"order.platenum"}}),r("div",{staticClass:"row col-xs-12"},[r("p",{staticClass:"caption"},[e._v("安检:")])]),r("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"车辆类型",options:e.vehicleOptions,before:[{icon:"format_list_bulleted"}],clearable:""},model:{value:e.order.vehicleType,callback:function(t){e.$set(e.order,"vehicleType",t)},expression:"order.vehicleType"}}),r("div",{staticClass:"row q-mb-lg gutter-xl"},[r("q-checkbox",{staticClass:"col q-mr-md",attrs:{val:"路试(100)",color:"amber","left-label":"",label:"路试(100)"},model:{value:e.secuAddition,callback:function(t){e.secuAddition=t},expression:"secuAddition"}}),r("q-checkbox",{staticClass:"col",attrs:{val:"称重(100)",color:"amber","left-label":"",label:"称重(100)"},model:{value:e.secuAddition,callback:function(t){e.secuAddition=t},expression:"secuAddition"}})],1),r("div",{staticClass:"row col-xs-12"},[r("p",{staticClass:"caption"},[e._v("环检:")])]),r("q-select",{staticClass:"col-xs-12 q-mb-lg",attrs:{"float-label":"燃油类型",options:e.fuelOptions,before:[{icon:"format_list_bulleted"}],clearable:""},model:{value:e.order.fuelType,callback:function(t){e.$set(e.order,"fuelType",t)},expression:"order.fuelType"}}),"汽油、天然气、电"==e.order.fuelType?r("div",{staticClass:"col-xs-12 row q-mb-lg gutter-y-sm"},[r("div",{staticClass:"col"},[r("q-radio",{attrs:{val:"初检(90)",color:"amber",label:"初检(90)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}})],1),r("div",{staticClass:"col"},[r("q-radio",{attrs:{val:"一次复检(0)",color:"amber",label:"一次复检(0)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}})],1),r("div",{staticClass:"col"},[r("q-radio",{attrs:{val:"二次复检(45)",color:"amber",label:"二次复检(45)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}})],1),r("div",{staticClass:"col"},[r("q-radio",{attrs:{val:"三次复检(90)",color:"amber",label:"三次复检(90)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}})],1)]):e._e(),"柴油"==e.order.fuelType?r("div",{staticClass:"row q-mb-lg gutter-y-sm"},[r("q-radio",{staticClass:"col",attrs:{val:"初检(60)",color:"amber",label:"初检(60)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}}),r("q-radio",{staticClass:"col",attrs:{val:"一次复检(0)",color:"amber",label:"一次复检(0)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}}),r("q-radio",{staticClass:"col",attrs:{val:"二次复检(30)",color:"amber",label:"二次复检(30)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}}),r("q-radio",{staticClass:"col",attrs:{val:"三次复检(60)",color:"amber",label:"三次复检(60)"},model:{value:e.order.envCheckType,callback:function(t){e.$set(e.order,"envCheckType",t)},expression:"order.envCheckType"}})],1):e._e(),r("q-datetime",{staticClass:"col-xs-12 q-mb-lg",attrs:{clearable:"","float-label":"预约时间",type:"datetime",before:[{icon:"date_range"}],"first-day-of-week":1,color:"light-blue","format-model":"number",min:e.settings.startDate,max:e.settings.endDate},model:{value:e.order.orderDate,callback:function(t){e.$set(e.order,"orderDate",t)},expression:"order.orderDate"}}),r("div",{staticClass:"row q-mb-lg gutter-xl"},[r("q-radio",{staticClass:"col",attrs:{val:"网上缴费",color:"amber","left-label":"",label:"网上缴费"},model:{value:e.order.paymentMethod,callback:function(t){e.$set(e.order,"paymentMethod",t)},expression:"order.paymentMethod"}}),r("q-radio",{staticClass:"col",attrs:{val:"现场缴费",color:"amber","left-label":"",label:"现场缴费"},model:{value:e.order.paymentMethod,callback:function(t){e.$set(e.order,"paymentMethod",t)},expression:"order.paymentMethod"}})],1),r("q-btn",{staticClass:"full-width",attrs:{loading:e.btnLoading,color:"positive",label:"预约"},on:{click:e.addOrder}})],1)])},a=[];o._withStripped=!0;r("KKXr"),r("f3/d");var s=r("MVZn"),l=r.n(s),i=r("SQGN"),n=function(e,t){return Math.floor(Math.random()*(t-e)+e)+""},d=r("L2JU"),c=r("ta7f"),p=new Date,u={data:function(){return{today:p,order:{name:"",phone:"",customerId:"",platenum:"",vehicleType:"",secuAddition:"",fuelType:"",envCheckType:"",orderDate:null,paymentMethod:"",payStatus:"未支付",orderNum:"",vehicleTypeFee:0,secuAdditionFee:0,envCheckTypeFee:0,totalFee:0},settings:{startDate:p,endDate:null,hourAmount:25},plateNumOptions:[],vehicleOptions:[{label:"小、微型汽车(1)",value:"小、微型汽车(1)"},{label:"轻型汽车(210)",value:"轻型汽车(210)"},{label:"中型汽车(290)",value:"中型汽车(290)"},{label:"重型半挂车、中型半挂车、轻型半挂车(300)",value:"重型半挂车、中型半挂车、轻型半挂车(300)"},{label:"危险品挂车(390)",value:"危险品挂车(390)"},{label:"大型、重型汽车(390)",value:"大型、重型汽车(390)"}],secuAddition:[],fuelOptions:[{label:"汽油、天然气、电",value:"汽油、天然气、电"},{label:"柴油",value:"柴油"}],btnLoading:!1}},computed:l()({},Object(d["c"])(["userInfo","registerInfo"])),validations:{order:{name:{required:c["required"]},phone:{required:c["required"]},platenum:{required:c["required"]},orderDate:{required:c["required"]}}},created:function(){var e=this;if(this.registerInfo)return this.disposeUnpaid(),void this.getSettings();this.$http.post("http://selinplus.natappvip.cc/customer/list?openid="+this.userInfo.openId).then(function(t){"200"==t.data.code&&(t.data.data?(e.$store.commit("saveRegisterInfo",t.data.data),e.disposeUnpaid(),e.getSettings()):(e.$q.notify({message:"请先登记",type:"negative",color:"negative",timeout:1e3,position:"top"}),setTimeout(function(){e.$router.push("/register")},1500)))})},methods:{disposeUnpaid:function(){var e=this;this.$http.get("http://selinplus.natappvip.cc/check/order/unpaid?customerId="+this.registerInfo.customer.id).then(function(t){"200"==t.data.code&&t.data.data&&e.$router.push({name:"预约详情",params:{orderNum:t.data.data.orderNum}})})},getSettings:function(){var e=this;this.order.name=this.registerInfo.customer.name,this.order.phone=this.registerInfo.customer.phone;for(var t=0;t<this.registerInfo.cars.length;t++){var r={label:this.registerInfo.cars[t].plateNum,value:this.registerInfo.cars[t].plateNum};this.plateNumOptions.push(r)}this.$http.post("http://selinplus.natappvip.cc/order/setting/getSettings").then(function(t){t.data.data&&(e.settings=t.data.data)})},checkOrderDate:function(e){this.$http.post("http://selinplus.natappvip.cc/check/order/checkOrderDate?orderDate="+this.order.orderDate+"&hourAmount="+this.settings.hourAmount).then(function(t){e(t.data.data)})},keyValueSplit:function(e){var t=e.split("(")[0],r=parseFloat(e.split("(")[1].split(")")[0]);return{key:t,value:r}},addOrder:function(){var e=this;if(this.order.name=this.registerInfo.customer.name,this.order.phone=this.registerInfo.customer.phone,this.order.customerId=this.registerInfo.customer.id,this.order.orderNum=Date.now()+n(1e5,999999),""!=this.order.vehicleType){var t=this.keyValueSplit(this.order.vehicleType);this.order.vehicleType=t.key,this.order.vehicleTypeFee=t.value}if(""!=this.secuAddition){for(var r=[],o=0;o<this.secuAddition.length;o++){t=this.keyValueSplit(this.secuAddition[o]);this.order.secuAdditionFee+=t.value,r.push(t.key)}this.order.secuAddition=r.join(",")}if(""!=this.order.envCheckType){t=this.keyValueSplit(this.order.envCheckType);this.order.envCheckType=t.key,this.order.envCheckTypeFee=t.value}this.order.totalFee=this.order.vehicleTypeFee+this.order.secuAdditionFee+this.order.envCheckTypeFee,this.$v.order.name.required?this.$v.order.phone.required?this.$v.order.platenum.required?this.$v.order.orderDate.required?""==this.order.vehicleType&&""==this.fuelType?this.$q.notify("车辆类型和燃油类型不能同时为空！"):this.checkOrderDate(function(t){t?e.$q.notify(t):e.$http.post("http://selinplus.natappvip.cc/check/order/add",e.order).then(function(t){200==t.data.code?"现场缴费"==e.order.paymentMethod?e.$router.push({name:"预约详情",params:{orderNum:e.order.orderNum}}):"网上缴费"==e.order.paymentMethod&&e.$http.post("http://selinplus.natappvip.cc/pay/createOrder",{body:"JSAPITEST",outTradeNo:e.order.orderNum,totalFee:e.order.totalFee,spbillCreateIp:"218.56.36.83",notifyUrl:"http://selinplus.natappvip.cc/pay/parseOrderNotifyResult",tradeType:"JSAPI",openid:e.userInfo.openId,signType:"MD5"}).then(function(t){console.log(t.data);var r=e;i["c"](t.data,function(e){r.$router.push({name:"预约详情",params:{orderNum:r.order.orderNum}})},function(e){r.$router.push({name:"预约详情",params:{orderNum:r.order.orderNum}})})}).catch(function(e){console.log(e)}):e.$q.notify({color:"negative",icon:"mood_bad",message:t.data.message,position:"top",timeout:1e3})}).catch(function(e){console.log(e)})}):this.$q.notify("预约时间不能为空！"):this.$q.notify("车牌号不能为空！"):this.$q.notify("手机号不能为空！"):this.$q.notify("联系人不能为空！")}}},h=u,v=(r("IdcS"),r("KHd+")),m=Object(v["a"])(h,o,a,!1,null,null,null);t["default"]=m.exports},"tWI/":function(e,t,r){}}]);